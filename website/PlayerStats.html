<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SG@SG - Player Metrics</title>
    <!-- Vite will handle this in development -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom Grid for the specific 3 rows of 6 columns request on large screens */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 1.5rem;
        }

        @media (min-width: 640px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .stats-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (min-width: 1400px) {
            .stats-grid {
                grid-template-columns: repeat(5, 1fr);
            }
        }

        .gauge-container {
            position: relative;
            width: 100%;
            padding-bottom: 60%;
            /* Aspect ratio */
            height: 0;
            overflow: hidden;
        }

        .gauge-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .needle {
            transition: transform 1s cubic-bezier(0.4, 0.0, 0.2, 1);
            transform-origin: 100px 90px;
            /* Pivot point matching SVG coordinate space */
        }

        .needle-label {
            font-size: 12px;
            font-weight: bold;
            fill: #374151;
            text-anchor: middle;
            pointer-events: none;
        }
    </style>
</head>

<body class="bg-gray-100 text-gray-800">

    <header class="bg-white shadow-md">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center">
                <img src="assets/SG-SG Map.png" alt="SG-SG Map" class="h-12 w-12 mr-4" onerror="this.style.display='none'">
                <a href="index.html"
                    class="text-2xl font-bold text-gray-800 hover:text-green-700 transition duration-300">SG@SG</a>
                <img src="assets/Sterling Grove Flag.png" alt="Sterling Grove Flag" class="h-12 w-12 ml-4"
                    onerror="this.style.display='none'">
            </div>
            <nav class="hidden md:flex space-x-8">
                <a href="index.html" class="text-gray-600 hover:text-green-700 transition duration-300">Home</a>
                <a href="index.html#events"
                    class="text-gray-600 hover:text-green-700 transition duration-300">Events</a>
                <a href="index.html#leaderboard"
                    class="text-gray-600 hover:text-green-700 transition duration-300">Leaderboard</a>
                <a href="index.html#contact"
                    class="text-gray-600 hover:text-green-700 transition duration-300">Contact</a>
            </nav>
            <button class="md:hidden flex items-center">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7">
                    </path>
                </svg>
            </button>
        </div>
    </header>

    <main class="container mx-auto px-6 py-12">
        <section class="bg-white p-8 rounded-lg shadow-lg">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-bold text-gray-900 mb-2">Player Metrics</h2>
                <p class="text-gray-600">Net Score vs Par</p>
            </div>

            <div id="player-grid" class="stats-grid">
                <!-- Grid will be populated by JS -->
            </div>

            <div class="mt-10 pt-6 border-t border-gray-200 text-center text-sm text-gray-500">
                <p class="font-semibold mb-2">Gauge Legend</p>
                <div class="flex justify-center items-center gap-4 flex-wrap">
                    <span class="flex items-center gap-1"><span class="w-3 h-3 rounded-full bg-green-500"></span>
                        Excellent (<= Par)</span>
                            <span class="flex items-center gap-1"><span
                                    class="w-3 h-3 rounded-full bg-yellow-500"></span> Average (<= +5)</span>
                                    <span class="flex items-center gap-1"><span
                                            class="w-3 h-3 rounded-full bg-red-500"></span> High (> +5)</span>
                </div>
            </div>
        </section>
    </main>

    <footer id="contact" class="bg-gray-800 text-white mt-12">
        <div class="container mx-auto px-6 py-10">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center md:text-left">
                <div>
                    <h3 class="font-bold text-lg mb-4">Sterling Grove Golf and Country Club</h3>
                    <p class="text-gray-400">11440 North Greenwich Boulevard<br>Surprise, AZ 85388</p>
                </div>
                <div>
                    <h3 class="font-bold text-lg mb-4">Quick Links</h3>
                    <ul>
                        <li class="mb-2"><a href="index.html" class="text-gray-400 hover:text-white">Home</a></li>
                        <li class="mb-2"><a href="index.html#events" class="text-gray-400 hover:text-white">Events</a>
                        </li>
                        <li class="mb-2"><a href="index.html#leaderboard"
                                class="text-gray-400 hover:text-white">Leaderboard</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-bold text-lg mb-4">Contact Us</h3>
                    <p class="text-gray-400">Paul Benga: <a href="https://wa.me/14806202088" class="hover:text-white"
                            target="_blank" rel="noopener noreferrer">WhatsApp</a></p>
                    <p class="text-gray-400">Patrick Schueppert: <a href="https://wa.me/17024996923"
                            class="hover:text-white" target="_blank" rel="noopener noreferrer">WhatsApp</a></p>
                    <p class="text-gray-400">Chris Royce: <a href="https://wa.me/17195104311" class="hover:text-white"
                            target="_blank" rel="noopener noreferrer">WhatsApp</a></p>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-6 text-center text-gray-500">
                <p>&copy; 2025 SG@SG. All Rights Reserved.</p>
            </div>
        </div>
    </footer>
    <script>
        const playerStatsData = `Player,Gross_Score,net_score,Net_to_Par
Andrew Burnheimer,83.0,83.0,11.0
Andy Meach,82.57,76.65,4.65
Ben Magnone,83.67,72.28,0.28
Brad Ackley,92.0,78.1,6.1
Brian Howell,81.5,74.85,2.85
Bud Scott,87.5,77.7,5.7
Buddy Goldstone,91.5,78.25,6.25
Chris Beck,89.0,74.84,2.84
Chris Husong,85.4,75.72,3.73
Chris Ryan,91.5,76.98,4.98
Christopher Royce,91.18,77.35,5.35
Clark Koch,81.62,74.06,2.06
Conrad Copeland,91.0,79.2,7.2
Dan Denham,79.67,74.37,2.37
Dana Beckley,90.0,83.2,11.2
Darrin Harn,77.0,77.0,5.0
David Adams,83.0,74.6,2.6
David Edwards,81.0,72.4,0.4
David Pearson,83.0,73.4,1.4
Dean Fisk,85.67,76.43,4.43
Derek Becko,78.57,74.19,2.19
Dusty Wasmund,81.0,73.08,1.08
Eric Lamb,96.0,72.0,0.0
Eric Weiss,72.78,72.42,0.42
Frank Angeloro,80.67,72.41,0.41
Glenn Brand,91.5,80.5,8.5
Greg Funk,77.55,73.42,1.42
Hans Anderson,73.67,73.3,1.3
James Feutz,69.5,70.6,-1.4
Jamey Davis,85.25,71.78,-0.23
Jared Strathe,69.33,72.2,0.2
Jeff Avery,86.67,75.17,3.17
Jeff Cloepfil,84.43,74.13,2.13
Jeff De Laveaga,70.5,70.35,-1.65
Jim Restivo,88.57,75.61,3.61
Joe Sepessy,77.67,72.7,0.7
Jon Vrolyks,82.43,76.81,4.81
Justin Deuker,78.33,74.33,2.33
Ken Vonwald,95.0,80.8,8.8
Kevin Barber,89.43,73.36,1.36
Kevin Mueller,89.0,79.6,7.6
Kiernan Mattson,76.29,75.68,3.68
Korey Jerome,85.4,76.64,4.64
Larry Caplan,93.8,78.4,6.4
Mark Albedyll,92.8,76.52,4.52
Mark James,90.0,78.17,6.17
Mark Lewis,87.14,76.21,4.21
Matt Neimeier,86.38,74.99,2.99
Matt Pullen,73.0,73.1,1.1
Michael Falagrady,81.33,75.2,3.2
Mike Muller,82.78,75.77,3.77
Nate Adams,67.5,73.55,1.55
Neil Harris,71.4,73.12,1.12
Pat Feutz,77.0,71.4,-0.6
Patrick Schueppert,94.64,79.05,7.05
Paul Benga,78.58,74.06,2.06
Rich Fagan,89.6,76.06,4.06
Rich Mckeon,86.0,73.0,1.0
Richard Lederman,88.17,75.36,3.36
Rick Deloney,84.57,77.61,5.61
Rick Meewes,78.5,73.22,1.23
Rob Oliver,91.8,74.64,2.64
Robert Hill,98.17,79.82,7.82
Ron Amstutz,85.86,74.63,2.63
Ron Marino,81.0,74.32,2.32
Scott Benton,89.43,77.7,5.7
Scott Bracken,82.62,73.18,1.18
Scott Lucas,84.6,72.0,0.0
Shane Bolosan,84.73,74.82,2.82
Shawn Warner,86.5,73.8,1.8
Stephen Cherepy,87.0,76.0,4.0
Steve Mccormick,85.6,75.68,3.68
Steve Rosenbluth,85.67,77.1,5.1
Stewart Polakov,74.0,69.1,-2.9
Thomas Earl,83.0,78.0,6.0
Todd Densley,73.43,73.4,1.4
Tracy Copenhaver,92.0,75.0,3.0
Travis Ingram,80.6,73.58,1.58
Travis Jorgensen,84.0,75.3,3.3
Trent Dana,92.83,77.13,5.13
Win Doolittle,90.0,82.0,10.0
Zach Coe,74.33,74.0,2.0
Zach Fleishman,86.33,73.57,1.57
Zach Mattson,79.0,72.9,0.9
Zane Eisenbarth,82.17,76.5,4.5`;

        // CSV Parser Function
        function parseCSV(data) {
            const lines = data.trim().split(/\r?\n/);
            // Remove header
            const rows = lines.slice(1);

            return rows.map(line => {
                const cols = line.split(',').map(item => item.trim());
                if (cols.length < 4) return null;

                return {
                    name: cols[0],
                    gross: Math.round(parseFloat(cols[1])),
                    net: Math.round(parseFloat(cols[2])),
                    netToPar: parseFloat(cols[3])
                };
            }).filter(item => item !== null);
        }

        function loadData() {
            try {
                // Use embedded data
                let playerData = parseCSV(playerStatsData);

                // SORT: Lowest Net to Par to Highest
                playerData.sort((a, b) => a.netToPar - b.netToPar);

                const gridContainer = document.getElementById('player-grid');
                let htmlContent = '';

                playerData.forEach(player => {
                    htmlContent += createPlayerCard(player);
                });

                gridContainer.innerHTML = htmlContent;

            } catch (err) {
                console.error(err);
                document.getElementById('player-grid').innerHTML = '<div class="col-span-full text-center text-red-500">Error loading data</div>';
            }
        }

        // Config for the gauge
        const MIN_SCORE = 60;
        const MAX_SCORE = 100;

        function getStatus(netToPar) {
            // Logic:
            // <= 0: Green
            // 0.001 - 5: Yellow
            // > 5: Red

            if (netToPar <= 0) {
                return { color: "#22c55e", text: "Excellent" }; // Green
            } else if (netToPar > 0 && netToPar <= 5) {
                return { color: "#eab308", text: "Average" }; // Yellow
            } else {
                return { color: "#ef4444", text: "High" }; // Red
            }
        }

        function calculateRotation(score) {
            // Map score to -90deg (min) to 90deg (max)
            const clampedScore = Math.max(MIN_SCORE, Math.min(MAX_SCORE, score));
            const percentage = (clampedScore - MIN_SCORE) / (MAX_SCORE - MIN_SCORE);
            return (percentage * 180) - 90;
        }

        function calculateTipCoordinates(rotationDeg) {
            const length = 75;
            const cx = 100;
            const cy = 90;
            const radians = rotationDeg * (Math.PI / 180);
            const x = cx + length * Math.sin(radians);
            const y = cy - length * Math.cos(radians);
            return { x, y };
        }

        function createPlayerCard(data) {
            const rotation = calculateRotation(data.net);
            const status = getStatus(data.netToPar);
            const needleColor = status.color; // Needle matches status color

            // Calculate Relative Score Text
            const sign = data.netToPar > 0 ? "+" : "";
            const relScore = data.netToPar === 0 ? "E" : sign + data.netToPar;

            // Calculate label position
            const labelPos = calculateTipCoordinates(rotation);

            return `
                <div class="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl transition-shadow duration-300 flex flex-col border border-gray-100">
                    <div class="p-4 border-b border-gray-100 text-center bg-gray-50">
                        <h3 class="text-lg font-bold text-gray-800 truncate" title="${data.name}">${data.name}</h3>
                        <p class="text-sm text-gray-500 font-medium">Gross: <span class="text-gray-800 font-bold">${data.gross}</span></p>
                    </div>
                    
                    <div class="p-4 flex flex-col items-center">
                        <div class="gauge-container">
                            <svg class="gauge-svg" viewBox="0 0 200 120">
                                <!-- Background Arc -->
                                <path d="M20 90 A 80 80 0 0 1 180 90" 
                                      fill="none" 
                                      stroke="#f3f4f6" 
                                      stroke-width="20" 
                                      stroke-linecap="round" />
                                
                                <!-- Needle -->
                                <g class="needle" style="transform: rotate(${rotation}deg);">
                                    <line x1="100" y1="90" x2="100" y2="25" stroke="${needleColor}" stroke-width="4" stroke-linecap="round" />
                                    <circle cx="100" cy="90" r="6" fill="${needleColor}" />
                                </g>
                                
                                <!-- Absolute Score Label at Tip -->
                                <rect x="${labelPos.x - 14}" y="${labelPos.y - 18}" width="28" height="16" rx="4" fill="${needleColor}" />
                                <text x="${labelPos.x}" y="${labelPos.y - 6}" font-size="10" fill="white" font-weight="bold" text-anchor="middle">${data.net}</text>
                                
                                <!-- Tick Marks -->
                                <text x="20" y="110" font-size="10" fill="#9ca3af" text-anchor="middle">${MIN_SCORE}</text>
                                <text x="100" y="110" font-size="10" fill="#9ca3af" text-anchor="middle">80</text>
                                <text x="180" y="110" font-size="10" fill="#9ca3af" text-anchor="middle">${MAX_SCORE}</text>
                            </svg>
                        </div>

                        <div class="mt-[-10px] text-center">
                            <span class="text-3xl font-bold" style="color: ${status.color}">${relScore}</span>
                            <span class="text-xs text-gray-400 block uppercase tracking-wide">To Par</span>
                        </div>
                    </div>
                </div>
            `;
        }

        window.onload = loadData;

    </script>
</body>

</html>